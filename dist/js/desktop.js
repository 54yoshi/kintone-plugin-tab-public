!function(){"use strict";const e=kintone.$PLUGIN_ID,o=kintone.plugin.app.getConfig(e),t=location.origin;let a;o&&(a={tabSettings:JSON.parse(o.tabSettings),editFormData:JSON.parse(o.editFormData)});const{editFormData:n,tabSettings:r}=a,{backgroundColor:l,fontColor:d,spaceField:s,tabs:i}=r;function c(e,o){let t=0;for(let a=0;a<e.layout.length;a++){const n=e.layout[a];if("GROUP"===n.type)for(let e=0;e<n.layout.length;e++){const r=n.layout[e];for(let e=0;e<r.fields.length;e++){const n=r.fields[e];if(n?.elementId===o){t=a;break}}}else for(let e=0;e<n.fields.length;e++){const r=n.fields[e];if(r?.elementId===o){t=a;break}}}return t}kintone.events.on(["app.record.detail.show","app.record.edit.show","app.record.create.show"],(async function(){const o=kintone.app.getId();if(!a)return;const n=kintone.app.record.getSpaceElement(r.spaceField);if(!n)return void function(){const a=document.createElement("div");a.className="custom-alert-banner";const n=t+`/k/admin/app/${o}/plugin/`+`config?pluginId=${e}`;a.innerHTML='タブプラグインで設定されていたスペースフィールドが見つかりません。<a href="'+n+'"" style="margin-left:8px;color:#fff;text-decoration:underline;">設定画面を開く</a>';const r=kintone.app.record.getHeaderMenuSpaceElement();r?r.appendChild(a):document.body.appendChild(a),setTimeout((()=>{a.classList.add("show")}),20)}();const p=Array.from(document.querySelectorAll("#record-gaia .layout-gaia > .row-gaia, #record-gaia .layout-gaia > .subtable-row-gaia")),u=c(await kintone.api(kintone.api.url("/k/v1/app/form/layout.json",!0),"GET",{app:o}),s),y=p.slice(u+1);console.log(y,"lowerRowNodes");const b=document.createElement("div");b.classList.add("parentDiv"),b.style.borderBottom=`2px solid ${r.backgroundColor}`,i.forEach(((e,o)=>{const t=document.createElement("div");t.classList.add("tab"),b.appendChild(t),t.textContent=""===e.tabName?`タブ${o+1}`:e.tabName,0===o&&(t.style.backgroundColor=l,t.style.color=d,t.style.border=`2px solid ${r.backgroundColor}`),t.addEventListener("click",(()=>{document.querySelectorAll(".tab").forEach((e=>{e.style.backgroundColor="rgb(229, 229, 229)",e.style.color="#8d8d8d",e.style.border="2px solid #e3e2e2"})),t.style.backgroundColor=l,t.style.color=d,t.style.border=`2px solid ${r.backgroundColor}`,y.forEach(((t,a)=>{t.style.display="none",(e.startRowIndex<=a&&a<i[o+1]?.startRowIndex||e.startRowIndex<=a&&void 0===i[o+1])&&(t.style.display="")}))})),y.forEach(((e,o)=>{e.style.display="none",(0<=o&&o<i[1]?.startRowIndex||0<=o&&void 0===i[1])&&(e.style.display="")}))})),n.appendChild(b)})),kintone.events.on(["mobile.app.record.detail.show","mobile.app.record.edit.show","mobile.app.record.create.show"],(async function(){const e=kintone.mobile.app.getId();if(!a)return;const o=kintone.mobile.app.record.getSpaceElement(s);if(!o)return;const t=await kintone.api(kintone.api.url("/k/v1/app/form/layout.json",!0),"GET",{app:e});console.log(t,"formLayout");const n=Array.from(document.querySelectorAll(".layout-gaia > *")),p=c(t,s),u=n.slice(p+1),y=document.createElement("div");y.classList.add("mobile-parentDiv"),y.style.borderBottom=`2px solid ${r.backgroundColor}`,i.forEach(((e,o)=>{const t=document.createElement("div");t.classList.add("tab"),y.appendChild(t),t.textContent=""===e.tabName?`タブ${o+1}`:e.tabName,0===o&&(t.style.backgroundColor=l,t.style.color=d,t.style.border=`2px solid ${r.backgroundColor}`),t.addEventListener("click",(()=>{document.querySelectorAll(".tab").forEach((e=>{e.style.backgroundColor="rgb(229, 229, 229)",e.style.color="#8d8d8d",e.style.border="2px solid #e3e2e2"})),t.style.backgroundColor=l,t.style.color=d,t.style.border=`2px solid ${r.backgroundColor}`,u.forEach(((t,a)=>{t.style.display="none",(e.startRowIndex<=a&&a<i[o+1]?.startRowIndex||e.startRowIndex<=a&&void 0===i[o+1])&&(t.style.display="")}))})),u.forEach(((e,o)=>{e.style.display="none",(0<=o&&o<i[1]?.startRowIndex||0<=o&&void 0===i[1])&&(e.style.display="")}))})),o.appendChild(y)}))}();